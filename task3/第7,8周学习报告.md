## 本周学习任务  

- 制作windows7或者centos7或者ubuntu的镜像，格式为qcow2
- 利用openstack上传镜像
- 能够成功创建、开启实例  

### - 第七周学习报告  

#### iso和qcow2、img格式的区别  

- **iso格式**：ISO文件其实就是光盘的镜像文件，刻录软件可以直接把ISO文件刻录成可安装的系统光盘，ISO文件一般以iso为扩展名，其文件格式为iso9660。ISO 9660，也被一些硬件和软件供应商称作CDFS（光盘文件系统），是一个由国际标准化组织（ISO）为光盘媒介发布的文件系统。其目标是能够在不同的操作系统，如Windows，Mac OS以及类Unix系统上交换数据。通常ISO文件被用于在网络上传输整张光盘的完整信息。 要得到ISO文件，需要对整张光盘的所有扇区按顺序复制下来，每个扇区的大小为2048字节。  
- **img格式**：IMG是一种文件压缩格式（archive format），主要是为了创建软盘的镜像文件（disk image），它可以用来压缩整个软盘（通常指软软盘，Floppy Disk或Diskette）或整片光盘的内容，使用".IMG"这个扩展名的文件就是利用这种文件格式来创建的。.IMG这个文件格式可视为.ISO格式的一种超集合。由于.ISO只能压缩使用ISO9660和UDF这两种文件系统的存储媒介，意即.ISO只能拿来压缩CD或DVD，因此才发展出了.IMG，它是以.ISO格式为基础另外新增可压缩使用其它文件系统的存储媒介的能力，.IMG可向后兼容于.ISO，如果是拿来压缩CD或DVD，则使用.IMG和.ISO这两种格式所压缩出来的内容是一样的。打开方式可以是光盘刻录，也可以用软件解压。  
- **qcow2格式**：qcow2 镜像格式是 QEMU 模拟器支持的一种磁盘镜像。它也是可以用一个文件的形式来表示一块固定大小的块设备磁盘。它支持稀疏文件（即支持空洞）以节省存储空间，它支持可选的AES加密以提高镜像文件安全性，支持基于zlib的压缩，支持在一个镜像文件中有多个虚拟机快照。可以使用iso制作qcow2镜像。  

#### 为什么要自己制作镜像  

- 制作镜像，对于经常要使用的光盘，又不能直接拷出来使用，可以做成镜像保存在硬盘上，这样又能保护光驱和光盘，也方便一些，对于一些硬盘上的成堆的小文件，又不需要修改，每次只是要读，也可以做成镜像，这样文件碎片会少一些。还有，刻录光盘前也可以先做成镜像试用一下，有没有什么不妥的地方，可以防止误刻。并且镜像文件的应用范围比较广泛，最常见的应用就是数据备份（如软盘和光盘）。  

#### 镜像制作到启动的步骤总结

- ①准备工作：准备好需要的iso镜像文件  
- ②首先用qemu-image创建ISO需安装在的系统盘centos.qcow2  
- ③再执行virt-install创建并启动虚拟机  
- ④然后使用vnc viewer远程连接vm并安装OS  
- ⑤完成启动，然后关闭vm，再把qcow2镜像上传到OpenStack  
- ⑥可以再在OpenStack使用上传的镜像创建新的实例  
- ⑦利用远程桌面连接该实例，测试镜像是否成功

#### 跟镜像相关的openstack的一些命令了解

##### 镜像（glance）

- 列出您可以访问的镜像

```
$ openstack image list
```  

- 删除指定的镜像  

```
$ openstack image delete IMAGE
```  

- 描述一个指定的镜像  

```
$ openstack image show IMAGE
```  

- 更新镜像  

```
$ openstack image set IMAGE
```  

- 上传内核镜像  

```
$ openstack image create "cirros-threepart-kernel" \
  --disk-format aki --container-format aki --public \
  --file ~/images/cirros-0.3.5-x86_64-kernel
```  

- 上传RAM镜像  

```
$ openstack image create "cirros-threepart-ramdisk" \
  --disk-format ari --container-format ari --public \
  --file ~/images/cirros-0.3.5-x86_64-initramfs
```  

- 上传第三方镜像  

```
$ openstack image create "cirros-threepart" --disk-format ami \
  --container-format ami --public \
  --property kernel_id=$KID-property ramdisk_id=$RID \
  --file ~/images/cirros-0.3.5-x86_64-rootfs.img
```  

- 注册raw镜像

```
$ openstack image create "cirros-raw" --disk-format raw \
  --container-format bare --public \
  --file ~/images/cirros-0.3.5-x86_64-disk.img
```  

### - 第八周学习报告  

