# task4操作文档

## 任务：

**安装云桌面**

- 提供vindesk部署安装包，根据安装文档来安装（忽略**激活管理系统**部分），注意配置localrc的时候，按服务器小组分配情况配置openstack的ip地址和密码。
- 安装完成无报错，并且能够打开系统并截图即为任务成功
- 可以自行探索下相关的功能

**云桌面系统功能体验**

- 创建固定桌面
- 创建一个课程，并创建一个对应的课程桌面，课程名称请命名为自己的分支



## 具体操作

上周制作了centos镜像并上传到了openstack平台，本次使用将使用该镜像创建虚拟机。

### 1. 安装云桌面

（1）准备安装脚本，将安装文件拷贝到待部署的服务器上

这里所使用的服务器为本地安装了ubuntu14 server的虚拟机，我们将在上面部署云桌面管理系统。以下是先通过pscp将安装文件上传至服务器。

![1.1-copy scripts](images/1.1-copy scripts.png?raw=true)



（2）解压安装脚本

```bash
$ tar -zxvf web_edu_v1.7.4.0_20171020.tar.gz
```



（3）进入解压后的文件夹下的build文件夹，按文档中的提示编辑localrc参数文件并保存



（4）运行安装脚本

运行安装脚本需要root权限，可先切换到root用户再运行脚本，安装成功后提示如下。

![1.4-run install](images/1.4-run install.png?raw=true)



（5）检查各个服务的状态是否正常

![2.1 show status](images/2.1 show status.png?raw=true)



以上服务均正常运行，可通过浏览器访问该管理系统。在浏览器输入服务器的ip地址即可进入管理系统的登录页面。可使用admin账户登入（密码admin123）。

![login page](images/login page.jpg?raw=true)



登录后的界面如图：

![3.0-home page](images/3.0-home page.png?raw=true)



### 2. 云桌面系统功能体验

（1）创建一个固定桌面

如下图，点击左侧的桌面管理项目，然后点击创建按钮。

![4.1-create fixed desktop](images/4.1-create fixed desktop.png?raw=true)



然后填写桌面的信息，并注意桌面配置要能满足镜像的要求。

![4.2-info](images/4.2-info.png?raw=true)



点击确定后可以看到新建的固定桌面已经出现在列表中，并且能看到其IP地址（即分配给该实例的浮动IP），并且状态为“已启动“，说明实例正常工作。

![4.3-status](images/4.3-status.png?raw=true)



我们可以开始在本地通过云桌面的客户端并使用admin账号登录（因为我们上面创建的固定桌面是分配给admin用户的）。验证服务器时使用的IP地址即我们部署管理系统的服务器的地址。如下图：

![4.4-login](images/4.4-login.png?raw=true)



验证后可以看到该用户有一个桌面可连接，但连接时提示无法连接。可能是因为协议设置不恰当，因此我们回到管理界面，点击编辑按钮进入固定桌面的设置。![4.4-enter setting](images/4.4-enter setting.png?raw=true)



原本的连接协议为RDP，我们尝试设置为vRay。

![4.4-setting](images/4.4-setting.png?raw=true)



然后再返回客户端重新连接即可进入上面创建好的固定桌面。

![4.5-login success](images/4.5-login success.png?raw=true)



（2）创建一个课程，并创建一个课程桌面

首先打开左侧的课程管理项目，然后点击创建课程。

![5.1-create course](images/5.1-create course.png?raw=true)



然后设置课程的信息，主要配置类型要确保能够满足镜像的最低要求（如存储空间最低要求），授课老师需要选择在系统上已经注册的教师用户。

![5.3-course info](images/5.3-course info1.png?raw=true)



系统已经预先提供了一个默认的教师用户和学生用户，可在用户管理界面查看。

![5.2-teacher list](images/5.2-teacher list.png?raw=true)



接着继续创建课程的第二步。这里的上课时间可以设置为包含当前的时间，这样待会便可以立即使用课程桌面，因为该系统会在课程时间之外自动回收课程桌面。![5.3-course info2](images/5.3-course info2.png?raw=true)



然后是创建课程的第三步，选课名单即学生用户的名单，这里的学生用户在系统上已经注册的用户，可以在用户管理界面创建新的学生用户或批量导入学生用户。

![5.3-course info3](images/5.3-course info3.png?raw=true)



创建完课程后，可以看到分配给该课程的2个课程桌面已经正常运行，且课程处于正在上课状态。

![5.4-create desktop](images/5.4-create desktop.png?raw=true)



我们可以通过客户端尝试连接其中一个课程桌面，这次在客户端应该使用student用户登录。

![5.4-login page](images/5.4-login page.png?raw=true)



登录后连接到桌面的效果如下：

![5.5-login](images/5.5-login.png?raw=true)