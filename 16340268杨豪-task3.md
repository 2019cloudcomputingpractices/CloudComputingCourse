## 学习周报

### 遇到的问题

在创建vm时我遇到了一个**ERROR：formot cannot be specified for unmanaged storage**，上网查找解决方法是要创建存储池，然而我创建存储池也失败了，于是就重启虚拟机重新做，第二次没有遇到这个ERROR，这令我有些不解。



### iso、img、qcow2

* iso

  ISO文件其实就是光盘的镜像文件，刻录软件可以直接把ISO文件刻录成可安装的系统光盘，ISO文件一般以iso为扩展名，其文件格式为iso9660。

* img

  IMG是一种文件压缩格式，主要是为了创建软盘的镜像文件，它可以用来压缩整个软盘或整片光盘的内容，使用".IMG"这个扩展名的文件就是利用这种文件格式来创建的。
  .IMG这个文件格式可视为.ISO格式的一种超集合。由于.ISO只能压缩使用ISO9660和UDF这两种文件系统的存储媒介，意即.ISO只能拿来压缩CD或DVD，因此才发展出了.IMG，它是以.ISO格式为基础另外新增可压缩使用其它文件系统的存储媒介的能力，.IMG可向后兼容于.ISO，如果是拿来压缩CD或DVD，则使用.IMG和.ISO这两种格式所压缩出来的内容是一样的。打开方式可以是光盘刻录，也可以用软件解压。

* qcow2

  qcow2 镜像格式是 QEMU 模拟器支持的一种磁盘镜像。它也是可以用一个文件的形式来表示一块固定大小的块设备磁盘。



### openstack镜像命令

* qemu-img create -f raw /Data/vm-node1-10G.raw 10G                                

  #创建raw格式并且大小为10G的磁盘

* virsh attach-disk vm-node1 /Data/vm-node1-10G.raw vdb --cache none                

  #临时生效，关机再开机后失效

* virsh dumpxml vm-node1                                                            

  #通过dumpxml找到下段配置文件

* fdisk -l                                                                            

  #数据盘已挂载，可以进行分区、格式化、挂载等操作

* qemu-img convert -p -f raw -O qcow2 test.raw test.qcow2                              

  #参数-p显示进度，-f是指原有的镜像格式，-O是输出的镜像格式，然后是输入文件和输出文件

* virsh list

  #查看运行的虚拟机

* virsh list --all

  #查看所有的虚拟机（关闭和运行的虚拟机）

* virsh console +域名（虚拟机的名称）

  #连接虚拟机

* ctrl+]

  #退出虚拟机

* virsh suspend +域名

  #挂起虚拟机

* virsh resume +域名

  #恢复被挂起的虚拟机

* virsh autostart + 域名

  #子机随宿主主机（母机）启动而启动

* virsh auotstart --disable +域名

  #取消自动启动

* virsh start 域名 --console

  #启动虚拟机并进入该虚拟机