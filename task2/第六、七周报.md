## 第六、七周学习周报  

### 本周任务  

- 用集成脚本一气呵成安装openstack，能够成功打开dashboard
+ 虚拟网络设置
- 开启实例  
  
### 具体描述：  
  
  1.成功搭建openstack环境后，通过dashboard登录。
  
  2.登陆后查看系统信息（看启动了什么服务）

  3.测试网络配置是否正确   
  >上传cirros镜像、创建flavor、创建vxlan网络、ext_net网络、路由

  >创建实例

  >添加安全组规则（ssh、icmp）

  >尝试从不同实例之间互相ping，看是否成功。以及实例能否ping通外网。  
  
  ### 已完成工作  
  - 用集成脚本一气呵成安装openstack，能够成功打开dashboard
  + 虚拟网络设置
  - 开启实例  
  ### 未完成工作  
  无  
    
  ### 第六周学习周报  
  #### openstack里的网络分类
  **1.Network**
  根据创建网络的用户的权限，Neutron network 可以分为以下两种：  
  
  Provider network：管理员创建的和物理网络有直接映射关系的虚拟网络。  
  
  Tenant network：租户普通用户创建的网络，物理网络对创建者透明，其配置由 Neutron根据管理员在系统中的配置决定。

  根据网络的类型，Neutron network 可以分为以下五种：
  VLAN network（虚拟局域网） ：基于物理 VLAN 网络实现的虚拟网络。共享同一个物理网络的多个 VLAN 网络是相互隔离的，甚至可以使用重叠的 IP 地址空间。每个支持 VLAN network 的物理网络可以被视为一个分离的 VLAN trunk，它使用一组独占的 VLAN ID。有效的 VLAN ID 范围是 1 到 4094。  
  
  Flat network：基于不使用 VLAN 的物理网络实现的虚拟网络。每个物理网络最多只能实现一个虚拟网络。  
  
  local network（本地网络）：一个只允许在本服务器内通信的虚拟网络，不知道跨服务器的通信。主要用于单节点上测试。  
  
  GRE network （通用路由封装网络）：一个使用 GRE 封装网络包的虚拟网络。GRE 封装的数据包基于 IP 路由表来进行路由，因此 GRE network 不和具体的物理网络绑定。  
  
  VXLAN network（虚拟可扩展网络）：基于 VXLAN 实现的虚拟网络。同 GRE network 一样， VXLAN network 中 IP 包的路由也基于 IP 路由表，也不和具体的物理网络绑定。  
  

  **2.Provider network**
  Provider Network 是由 OpenStack 管理员创建的，和物理网络的某段直接映射。这种网络是可以在多个租户之间共享的。  
  
  虽然可以创建 GRE 和 VXLAN 类型的 Provider network， 但是Provider network 只对 Flat 和 VLAN 类型的网络才有意义，因为 Provider network 的一个重要属性是 provider:physical_network，而这个参数对其他网络类型没有有意义。  
  

  **3.Tenant network**
  Tenant network 是由 tenant 的普通用户创建的网络。默认情况下，这类用户不能创建共享的 tenant network（因此Nuetron Server 的policy设置了"create_network:shared": "rule:admin_only"。），因此这种网络是完全隔离的，也不可以被别的 tenant 共享。  
  
  Tenant network 也有 local，flat，vlan，gre 和 vxlan 等类型。但是，tenant 普通用户创建的 Flat 和 VLAN tenant network 实际上还是 Provider network，所以真正有意义的是 GRE 和 VXLAN 类型，这种网络和物理网络没有绑定关系。  
  
  
  **4.Provider Network 和 Tenant Network 的区别**
  有以下几个区别：  
  
  Provider network 是由 Admin 用户创建的，而 Tenant network 是由 tenant 普通用户创建的。  
  
  Povider network 和物理网络的某段直接映射，比如对应某个 VLAN，因此需要预先在物理网络中做相应的配置。而 tenant network 是虚拟化的网络，Neutron 需要负责其路由等三层功能。  
  
  对 Flat 和 VLAN 类型的网络来说，只有 Provider network 才有意义。即使是这种类型的 tenant network，其本质上也是对应于一个实际的物理段。  
  
  对 GRE 和 VXLAN 类型的网络来说，只有 tenant network 才有意义，因为它本身不依赖于具体的物理网络，只是需要物理网络提供 IP 和 组播即可。  
  
  Provider network 根据 admin 用户输入的物理网络参数创建；而 tenant work 由 tenant 普通用户创建，Neutron 根据其网络配置来选择具体的配置，包括网络类型，物理网络和 segmentation_id。X`
  创建 Provider network 时允许使用不在配置项范围内的 segmentation_id。  
    
  #### 浮动IP的作用  
  **浮动IP**  
  >一个浮动IP通常是一个公开的、可以路由到的IP地址，并且不会自动分配给实体设备。项目管理者临时分配动态IP到一个或者多个实体设备。这个实体设备有自动分配的静态IP用于内部网间设备的通讯。这个内部网使用私有地址，这些私有地址不能被路由到。通过浮动IP内网实体的服务才能被外网识别和访问。  
   
  浮动IP的主要优点是灵活，自由的根据需要分配。浮动IP即适用于故障恢复又适用于服务切换。比如对某个应用或者整个站点的升级，并能保证对业务有最小的影响。当对一个应用升级时，另一个应用分配输入流量。一旦升级完成，流量会被重新导入到升级节点。另一个优点是：浮动IP对外提供统一的IP，而不是实际对外提供服务的IP地址。  
     
  #### 在界面创建一个实例会用到什么组件  
  - 创建OpenStack虚拟机实例需要调用OpenStack三大核心组件，分别是Keystone、Glance、Nova。其中Keystone负责授权认证、租户管理、项目权限和配额以及服务目录管理。Glance负责为Nova提供创建实例所需要的镜像文件，这种镜像文件可以包含很多格式，大多数都是我们常见的镜像格式，如raw、qcow2。Nova负责虚拟机生命周期的管理，以及宿主机资源调度。Nova还决定了虚拟机实例建立在哪一台Hypervisor物理机之上。  
    
  ### 第七周学习周报  
  **查看系统信息**  
  ![system service](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/system%20service.png)  
  **添加映像**  
  ![cirros](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/cirrors.png)  
  **配置内部&外部网络**  
  ![son net](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/son%20net.png)  
    
   ![out net](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/out%20net.png)  
   **配置路由器**
   ![router](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/router.png)  
   **创建实例**  
   ![instance](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/instance.png)  
   **登录cirros2控制台，查看网卡情况并检验和cirros1、cirros3能否ping通**
   ![ifconfig](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/ifconfig.png)  
   ![ping1](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/ping.png)  
   ![ping3](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/ping16.png)  
   **ping外部网关**
   ![pingout](https://github.com/2019cloudcomputingpractices/CloudComputingCourse/blob/16340124-%E6%9D%8E%E8%A8%80/task2/images/ping%20waiwang.png)  
     
   ### 遇到的问题
   创建实例失败时显示There is not enough host,上网查了一些资料没能成功解决，于是从头开始，又在horizon登录界面出现错误，虚拟机内显示out of memory[序列号](错误条目名称)，又从头开始才成功完成这次task。
